name = "rsp4copilot"
main = "src/workers.ts"
compatibility_date = "2025-12-24"
workers_dev = true
preview_urls = true

# Optional: Custom domain routing (uncomment and modify)
# [[routes]]
# pattern = "your-domain.com/*"
# zone_name = "your-domain.com"

[vars]
# 推荐：使用单一 JSONC 配置（RSP4COPILOT_CONFIG）描述所有 provider/model。
# `model` 支持短 ID（modelName）或完整 ID（providerId.modelName）；短 ID 有歧义时再用完整 ID。
RSP4COPILOT_CONFIG = '''
{
  "version": 1,
  "providers": {
    "openai": {
      "apiMode": "openai-responses",
      "baseURL": "https://your-relay.example/openai",
      "apiKeyEnv": "OPENAI_API_KEY",
      "models": {
        "gpt-5.1": { "upstreamModel": "gpt-5.1" },
        "gpt-5.1-codex-max": { "upstreamModel": "gpt-5.1-codex-max" },
        "gpt-5.2": { "upstreamModel": "gpt-5.2" },
        "gpt-5.2-codex": { "upstreamModel": "gpt-5.2-codex" }
      }
    },
    "gemini": {
      "apiMode": "gemini",
      "baseURL": "https://generativelanguage.googleapis.com",
      "apiKeyEnv": "GEMINI_API_KEY",
      "models": {
        "gemini-3-flash-preview": { "upstreamModel": "gemini-3-flash-preview" },
        "gemini-3-pro-preview": { "upstreamModel": "gemini-3-pro-preview" }
      }
    },
    "claude": {
      "apiMode": "claude",
      "baseURL": "https://api.anthropic.com",
      "apiKeyEnv": "CLAUDE_API_KEY",
      "models": {
        "claude-haiku-4-5-20251001": { "upstreamModel": "claude-haiku-4-5-20251001" },
        "claude-sonnet-4-5-20250929": { "upstreamModel": "claude-sonnet-4-5-20250929" },
        "claude-opus-4-5-20251101": { "upstreamModel": "claude-opus-4-5-20251101" }
      }
    }
  }
}
'''

# Debug logging (optional)
# RSP4COPILOT_DEBUG = "true"

# Chat history limits (optional; defaults shown; set 0 to disable)
# RSP4COPILOT_MAX_TURNS = 40
# RSP4COPILOT_MAX_MESSAGES = 200
# RSP4COPILOT_MAX_INPUT_CHARS = 300000

# Secrets (do not commit to git, use wrangler secret put):
#   wrangler secret put WORKER_AUTH_KEY
# Optional: multiple client auth keys (comma-separated):
#   wrangler secret put WORKER_AUTH_KEYS
#
# Upstream provider keys:
#   wrangler secret put OPENAI_API_KEY
#   wrangler secret put GEMINI_API_KEY
#   wrangler secret put CLAUDE_API_KEY

[observability]
enabled = true
